<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catchment Characteristics • geogrids</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Catchment Characteristics">
<meta property="og:description" content="geogrids">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geogrids</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basics.html">Basic Example</a>
    </li>
    <li>
      <a href="../articles/characteristics.html">Catchment Characteristics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mikejohnson51/geogrids/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="characteristics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Catchment Characteristics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikejohnson51/geogrids/blob/master/vignettes/characteristics.Rmd"><code>vignettes/characteristics.Rmd</code></a></small>
      <div class="hidden name"><code>characteristics.Rmd</code></div>

    </div>

    
    
<div id="climate" class="section level1">
<h1 class="hasAnchor">
<a href="#climate" class="anchor"></a>Climate</h1>
<div id="water" class="section level2">
<h2 class="hasAnchor">
<a href="#water" class="anchor"></a>Water</h2>
<div id="mean-precipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mean-precipitation" class="anchor"></a>Mean precipitation</h3>
<blockquote>
<p>Mean daily precipitation (mm/day)</p>
</blockquote>
<p><span style="color:blue">We will use the daily GridMet files for pr_* from 2010-2020. This will be used to compute a table with rows representing catchments, and columns representing a daily catchment mean </span>.</p>
</div>
<div id="snowfall-fraction" class="section level3">
<h3 class="hasAnchor">
<a href="#snowfall-fraction" class="anchor"></a>Snowfall Fraction</h3>
<blockquote>
<p>Fraction of precipitation falling as snow (i.e., on days colder than 0 °C)</p>
</blockquote>
<p><span style="color:blue">We will use the daily GridMet files for tmin_* from 2010-2020 to create a matrix mask. This mask will be applied to the mean daily PPT matrix to compute the fraction. We will use a temperature threshold following Keith Jennings <a href="https://www.nature.com/articles/s41467-018-03629-7">paper</a> and the data found <a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.c9h35">here</a> </span></p>
</div>
<div id="precip--seasonality" class="section level3">
<h3 class="hasAnchor">
<a href="#precip--seasonality" class="anchor"></a>Precip. seasonality</h3>
<blockquote>
<p>Seasonality and timing of precipitation (estimated using sine curves to represent the annual temperature and preciptiation cycles, positive [negative] values indicate that precipitation peaks in summer [winter], values close to 0 indicate uniform precipitation (<a href="https://www.sciencedirect.com/science/article/pii/S030917080900102X">eq 14</a>)</p>
</blockquote>
<p><span style="color:red">NOT SURE YET.</span></p>
</div>
<div id="high-precip--frequency" class="section level3">
<h3 class="hasAnchor">
<a href="#high-precip--frequency" class="anchor"></a>High precip. frequency</h3>
<blockquote>
<p>Frequency of high precipitation days (≥5 times mean daily precipitation) (days/year)</p>
</blockquote>
<p><span style="color:blue">Using the mean PPT matrix, the data will be grouped by year and the number of days exceeding 5mm will be computed </span>.</p>
</div>
<div id="high-precip--duration" class="section level3">
<h3 class="hasAnchor">
<a href="#high-precip--duration" class="anchor"></a>High precip. duration</h3>
<blockquote>
<p>average duration of high precipitation events (number of consecutive days ≥5 times mean daily precipitation) (days)</p>
</blockquote>
<p>Need to look <a href="https://stackoverflow.com/questions/54463950/r-count-consecutive-days-with-condition">here</a> for <code>data.table::rleid</code></p>
<p><span style="color:blue">Will be computed from daily PPT matrix</span>.</p>
</div>
<div id="low-precip--frequency" class="section level3">
<h3 class="hasAnchor">
<a href="#low-precip--frequency" class="anchor"></a>Low precip. frequency</h3>
<blockquote>
<p>frequency of dry days (&lt;1 mm/day) (days/year)</p>
</blockquote>
<p><span style="color:blue">Will be computed from daily PPT matrix </span>.</p>
</div>
<div id="low-precip--duration" class="section level3">
<h3 class="hasAnchor">
<a href="#low-precip--duration" class="anchor"></a>Low precip. duration</h3>
<blockquote>
<p>average duration of dry periods (number of consecutive days &lt;1 mm/day) (days)</p>
</blockquote>
<p>Need to look <a href="https://stackoverflow.com/questions/54463950/r-count-consecutive-days-with-condition">here</a> for <code>data.table::rleid</code></p>
</div>
</div>
<div id="energy" class="section level2">
<h2 class="hasAnchor">
<a href="#energy" class="anchor"></a>Energy</h2>
<div id="mean-pet" class="section level3">
<h3 class="hasAnchor">
<a href="#mean-pet" class="anchor"></a>Mean PET</h3>
<blockquote>
<p>Mean daily PET (estimated by N15 using Priestley-Taylor formulation calibrated for each catchment)</p>
</blockquote>
<p><span style="color:blue">We will use the daily GridMet files for pet_* from 2000-2020 to compute a mean daily normal </span>.</p>
</div>
<div id="aridity" class="section level3">
<h3 class="hasAnchor">
<a href="#aridity" class="anchor"></a>Aridity</h3>
<blockquote>
<p>Aridity (PET/P, ratio of mean PET [estimated by N15 using Priestley-Taylor formulation calibrated for each catchment] to mean precipitation)</p>
</blockquote>
<p><span style="color:blue">We will create a single AI layer computed as the mean daily PET divided by the mean daily PRCP </span>.</p>
</div>
</div>
</div>
<div id="catchment" class="section level1">
<h1 class="hasAnchor">
<a href="#catchment" class="anchor"></a>Catchment</h1>
<div id="area" class="section level3">
<h3 class="hasAnchor">
<a href="#area" class="anchor"></a>Area</h3>
<blockquote>
<p>Catchment area (Geospatial Fabric estimate) (km<sup>2</sup>)</p>
</blockquote>
<p><span style="color:blue">We be computed on hydrofabric geometries<code>(sum(x &gt;= rowMean(.))</code> </span>.</p>
</div>
<div id="mean-elevation" class="section level3">
<h3 class="hasAnchor">
<a href="#mean-elevation" class="anchor"></a>Mean elevation</h3>
<blockquote>
<p>Catchment mean elevation (meters)</p>
</blockquote>
<p><span style="color:blue">Will be extracted from NWM 1km geogrid <code>HGT_M</code> </span>. <span style="color:blue">Or the 4km GridMet Grid</span>.</p>
</div>
<div id="mean-slope" class="section level3">
<h3 class="hasAnchor">
<a href="#mean-slope" class="anchor"></a>Mean slope</h3>
<blockquote>
<p>Catchment mean slope (m/km)</p>
</blockquote>
<p><span style="color:blue">Will be computed and extracted from the elevation product </span>.</p>
</div>
</div>
<div id="soil" class="section level1">
<h1 class="hasAnchor">
<a href="#soil" class="anchor"></a>Soil</h1>
<div id="geological-permeability" class="section level3">
<h3 class="hasAnchor">
<a href="#geological-permeability" class="anchor"></a>Geological permeability</h3>
<blockquote>
<p>Subsurface permeability (log10) m2 from GLHYMPS</p>
</blockquote>
<p>Data from: Gleeson, T., Moosdorf ,N., Hartmann,J. and van Beek, L.P.H. (2014) A glimpse beneath earth’s surface: GLobal HYdrogeology MaPS (GLHYMPS) of permeability and porosity. Geophyscial Research Letters, 41: 2014GL059856 doi: 10.1002/2014gl059856</p>
<p>Using feild: logK_Ice_x100_INT from the supplied shapefile. Currently rasterizing this to the CONUS-Soil 1KM grid but this can be changed.</p>
</div>
<div id="frac--carbonate-sedimentary-rock" class="section level3">
<h3 class="hasAnchor">
<a href="#frac--carbonate-sedimentary-rock" class="anchor"></a>Frac. carbonate sedimentary rock</h3>
<blockquote>
<p>Fraction of the catchment area characterized as “Carbonate sedimentary rocks” from GLiM</p>
</blockquote>
<p>class where xx in dataset == ‘sc’. See Table 1 <a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2012GC004370">here</a></p>
</div>
<div id="clay-fraction" class="section level3">
<h3 class="hasAnchor">
<a href="#clay-fraction" class="anchor"></a>Clay fraction</h3>
<blockquote>
<p>clay fraction (of the soil material smaller than 2 mm, layers marked as oragnic material, water, bedrock and “other” were excluded) % (STATSGO)</p>
</blockquote>
<p><span style="color:blue"> Will extract the <code>clay.bsq</code> file distributed by Penn State and compute catchment mean </span>.</p>
</div>
<div id="silt-fraction" class="section level3">
<h3 class="hasAnchor">
<a href="#silt-fraction" class="anchor"></a>Silt Fraction</h3>
<blockquote>
<p>silt fraction (of the soil material smaller than 2 mm, layers marked as oragnic material, water, bedrock and “other” were excluded) % (STATSGO)</p>
</blockquote>
<p><span style="color:blue">Will extract the <code>silt.bsq</code> file distributed by Penn State and compute catchment mean</span>.</p>
</div>
<div id="sand-fraction" class="section level3">
<h3 class="hasAnchor">
<a href="#sand-fraction" class="anchor"></a>Sand fraction</h3>
<blockquote>
<p>sand fraction (of the soil material smaller than 2 mm, layers marked as organic material, water, bedrock and “other” were excluded) % (STATSGO)</p>
</blockquote>
<p><span style="color:blue">Will extract the <code>sand.bsq</code> file distributed by Penn State and compute catchment mean </span>.</p>
</div>
<div id="saturated-hyd--conductivity" class="section level3">
<h3 class="hasAnchor">
<a href="#saturated-hyd--conductivity" class="anchor"></a>Saturated hyd. conductivity</h3>
<blockquote>
<p>saturated hydraulic conductivity (estimated using a multiple linear regression based on sand and clay fraction for the layers marked as USDA soil texture class and a default value [36 cm/hr] for layers marked as organic material, layers marked as water, bedrock and “other” were excluded) cm/hr <a href="https://agupubs.onlinelibrary.wiley.com/doi/epdf/10.1029/WR020i006p00682">Table 4</a></p>
</blockquote>
<div id="x-sand---0-0064-x-clay" class="section level4">
<h4 class="hasAnchor">
<a href="#x-sand---0-0064-x-clay" class="anchor"></a>-0.60 + (0.0126 x %sand) - (0.0064 x %clay)</h4>
<p><span style="color:blue">Using the mean sand and clay percentages the above formula can be applied</span>.</p>
</div>
</div>
<div id="volumetric-porosity" class="section level3">
<h3 class="hasAnchor">
<a href="#volumetric-porosity" class="anchor"></a>Volumetric porosity</h3>
<blockquote>
<p>volumetric porosity (saturated volumetric water content estimated using a multiple linear regression based on sand and clay fraction for the layers marked as USDA soil texture class and a default value [0.9] for layers marked as organic material, layers marked as water, bedrock and “other” were excluded)</p>
</blockquote>
<div id="x-sand---0-037-x-clay" class="section level4">
<h4 class="hasAnchor">
<a href="#x-sand---0-037-x-clay" class="anchor"></a>50.5 - (0.142 x %sand) - (0.037 x %clay)</h4>
<p><span style="color:blue">Using the mean sand and clay percentages the above formula can be applied</span>.</p>
</div>
</div>
<div id="soil-depth-to-bedrock" class="section level3">
<h3 class="hasAnchor">
<a href="#soil-depth-to-bedrock" class="anchor"></a>Soil depth to bedrock</h3>
<blockquote>
<p>soil depth (maximum 1.5 m, layers marked as water and bedrock were excluded) (m)</p>
</blockquote>
<p><span style="color:blue">Will extract the <code>depth.bsq</code> file distributed by Penn State and compute catchment mean </span>.</p>
</div>
<div id="max--water-content" class="section level3">
<h3 class="hasAnchor">
<a href="#max--water-content" class="anchor"></a>Max. water content</h3>
<blockquote>
<p>maximum water content (combination of porosity and soil_depth_statsgo, layers marked as water, bedrock and “other” were excluded)</p>
</blockquote>
<p><span style="color:blue"> Multiply the porosity and the soil depth</span>.</p>
</div>
</div>
<div id="land-cover-veg" class="section level1">
<h1 class="hasAnchor">
<a href="#land-cover-veg" class="anchor"></a>Land Cover / Veg</h1>
<div id="frac--of-forest" class="section level2">
<h2 class="hasAnchor">
<a href="#frac--of-forest" class="anchor"></a>Frac. of Forest</h2>
<blockquote>
<p>forest fraction</p>
</blockquote>
<p><span style="color:blue">Will extract the percent forest from the MODIS land cover fit to the 1km Soil Grid </span>.</p>
</div>
<div id="max--green-veg--frac--gvf" class="section level2">
<h2 class="hasAnchor">
<a href="#max--green-veg--frac--gvf" class="anchor"></a>Max. green veg. frac. (GVF)</h2>
<blockquote>
<p>maximum monthly mean of the green vegetation fraction (based on 12 monthly means)</p>
</blockquote>
<p><span style="color:blue">Will Use MODIS 8 day NDVI to Compute GVF as {(NDVI - NDVImax)/NDVImax-NDVImin </span>.</p>
<p>where NDVI is the NDVI value at a grid point i, NDVI is a global constant given by the 5<sup>th</sup> percentile of NDVI<sub>max</sub> for the barren land use class, and NDVI<sub>V</sub> is the 90th percentile of NDVI<sub>max</sub> values for the land use class at grid point i. As NDVI composites are collected over a longer time period, the NDVImax can be periodically updated to reflect subtle variations in the distributions of NDVI<sub>max</sub> by land-use classification. <a href="https://weather.msfc.nasa.gov/sport/modeling/modisGVF.html">here</a></p>
</div>
<div id="annual-gvf-diff-" class="section level2">
<h2 class="hasAnchor">
<a href="#annual-gvf-diff-" class="anchor"></a>Annual GVF diff.</h2>
<blockquote>
<p>difference between the maximum and mimumum monthly mean of the green vegetation fraction (based on 12 monthly means)</p>
</blockquote>
</div>
<div id="annual-leaf-area-index-lai-diff-" class="section level2">
<h2 class="hasAnchor">
<a href="#annual-leaf-area-index-lai-diff-" class="anchor"></a>Annual leaf area index (LAI) diff.</h2>
<blockquote>
<p>difference between the maximum and mimumum monthly mean of the leaf area index (based on 12 monthly means)</p>
</blockquote>
<p><span style="color:blue">Will Use Monthly MODIS LAI</span>.</p>
</div>
<div id="max--lai" class="section level2">
<h2 class="hasAnchor">
<a href="#max--lai" class="anchor"></a>Max. LAI</h2>
<blockquote>
<p>maximum monthly mean of the leaf area index (based on 12 monthly means)</p>
</blockquote>
<p><span style="color:blue">Will Use Monthly MODIS LAI</span>.</p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div id="gridmet" class="section level3">
<h3 class="hasAnchor">
<a href="#gridmet" class="anchor"></a>Gridmet</h3>
<p>var: prcp, tmax. tmin, pet <br> dimensions : 585, 1386, 810810 (nrow, ncol, ncell) <br> resolution : 0.04166667, 0.04166667 (x, y) <br> extent : -124.7875, -67.0375, 25.04583, 49.42083 (xmin, xmax, ymin, ymax) <br> crs : +proj=longlat +ellps=WGS84 +no_defs <br></p>
</div>
<div id="modis-lai" class="section level3">
<h3 class="hasAnchor">
<a href="#modis-lai" class="anchor"></a>MODIS LAI</h3>
<p>dimensions : 862, 3283, 2829946 (nrow, ncol, ncell) <br> resolution : 0.01160146, 0.01160146 (x, y) <br> extent : -155.5724, -117.4848, 39.99954, 50 (xmin, xmax, ymin, ymax) <br> crs : +proj=longlat +a=6378249.145 +rf=293.465 +no_defs <br></p>
</div>
<div id="modis-lc" class="section level3">
<h3 class="hasAnchor">
<a href="#modis-lc" class="anchor"></a>MODIS LC</h3>
<p>dimensions : 4970, 17121, 85091370 (nrow, ncol, ncell) <br> resolution : 0.006036802, 0.006036802 (x, y) <br> extent : -155.5724, -52.2163, 19.99709, 50 (xmin, xmax, ymin, ymax) <br> crs : +proj=longlat +a=6378249.145 +rf=293.465 +no_defs <br></p>
</div>
<div id="modis-ndvi" class="section level3">
<h3 class="hasAnchor">
<a href="#modis-ndvi" class="anchor"></a>MODIS NDVI</h3>
<p>dimensions : 2485, 8560, 21271600 (nrow, ncol, ncell) <br> resolution : 0.0120736, 0.0120736 (x, y) <br> extent : -155.5724, -52.22233, 19.99709, 50 (xmin, xmax, ymin, ymax) <br> crs : +proj=longlat +a=6378249.145 +rf=293.465 +no_defs <br></p>
</div>
<div id="conus-soil" class="section level3">
<h3 class="hasAnchor">
<a href="#conus-soil" class="anchor"></a>CONUS Soil</h3>
<p>dimensions : 2896, 4616, 13367936 (nrow, ncol, ncell) <br> resolution : 1000, 1000 (x, y) <br> extent : -2357000, 2259000, 277000, 3173000 (xmin, xmax, ymin, ymax) <br> crs : +proj=aea +lat_0=23 +lon_0=-96 +lat_1=29.5 +lat_2=45.5 +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs <br></p>
</div>
<div id="gsrs" class="section level3">
<h3 class="hasAnchor">
<a href="#gsrs" class="anchor"></a>GSRS</h3>
<p>dimensions : 18000, 43200, 777600000 (nrow, ncol, ncell) <br> resolution : 0.008333333, 0.008333333 (x, y) <br> extent : -180, 180, -60, 90 (xmin, xmax, ymin, ymax) <br> crs : +proj=longlat +datum=WGS84 +no_defs <br></p>
</div>
<div id="glim" class="section level3">
<h3 class="hasAnchor">
<a href="#glim" class="anchor"></a>GLiM</h3>
<p>Vector Product</p>
<p>###GLHYMPS Vector Product</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mike Johnson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
