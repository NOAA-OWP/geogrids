---
title: "DEM Example"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  out.width = "100%",
  fig.width = 7, 
  fig.height = 4, dpi = 150, fig.path = "dem-",
  message = FALSE, warning = FALSE, error = FALSE
)

```


## Define AOI

```{r aoi}
library(sf)
library(stars)
library(geogrids)
library(ggplot2)

geom <- read_sf("hydrofabric.gpkg", "catchments") 

ggplot(geom) + 
  geom_sf(size = .01)
```

## Find, cache/download, Merge, and Plot DEM data

```{r dem}
# Identify needed NED tiles
files   = get_ned(geom, res = "1")
# Define location to write merged raster
tmpfile = tempfile(fileext = '.tif')

# Merge NED tiles into tempfile
merge_rasters(files, tmpfile)

# plot data!
plot(read_stars(tmpfile), main = "DEM")
```

```{r, echo = FALSE}
unlink(tmpfile)
```
